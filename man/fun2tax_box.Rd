% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fun2tax_box.R
\name{fun2tax_box}
\alias{fun2tax_box}
\title{Plot function-to-taxon contributions as grouped boxplots}
\usage{
fun2tax_box(
  stratified_path,
  pathway_sdaa_result,
  physeq,
  group,
  taxon_level = "Genus",
  pathway = c("KO", "EC", "MetaCyc"),
  value_col = "norm_taxon_function_contrib",
  wrap_width = 36,
  group_functions = TRUE
)
}
\arguments{
\item{stratified_path}{Character string. Path to a stratified PICRUSt2 output file
(typically `*_stratified.tsv`), containing columns for function, taxon, sample, and contribution values.}

\item{pathway_sdaa_result}{A named list of results from an SDAA (statistical differential abundance analysis)
step, keyed by function IDs. Only names are used here.}

\item{physeq}{A \code{\link[phyloseq]{phyloseq}} object containing sample metadata
and taxonomy table. Sample IDs must match those in \code{stratified_path}.}

\item{group}{Character scalar. Column name in sample metadata to use for grouping (e.g. treatment).}

\item{taxon_level}{Character scalar. It would be better to align your taxonomy level
to your pathway_sdaa_result.}

\item{pathway}{Character scalar. Functional annotation scheme used: one of
\code{"KO"}, \code{"EC"}, or \code{"MetaCyc"}. Defaults to "KO".}

\item{value_col}{Character scalar. Name of the numeric contribution column
in the stratified table. Defaults to \code{"norm_taxon_function_contrib"}.}

\item{wrap_width}{Integer. Width (in characters) for line-wrapping taxon labels
on the x-axis. Defaults to 36.}

\item{group_functions}{Logical. Whether to group function IDs into higher-level
reference categories (via reference maps included in the package). Defaults to \code{TRUE}.}
}
\description{
This function takes a stratified PICRUSt2 output table, a phyloseq object,
and a list of pathway-level results, and produces ggplot2 boxplots of
function contributions summarized by taxonomic level and experimental group.
}
\examples{
\dontrun{
# Example with KO pathway
plots <- fun2tax_box(
  stratified_path = "ko_metagenome_out_stratified.tsv",
  pathway_sdaa_result = sdaa_result,
  physeq = physeq_obj,
  group = "Treatment",
  taxon_level = "Genus",
  pathway = "KO"
)
# Display first plot
print(plots[[1]])
}


}
