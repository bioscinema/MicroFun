% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pathway_sdaa.R
\name{pathway_sdaa}
\alias{pathway_sdaa}
\title{Stratified Pathway Differential Abundance Analysis}
\usage{
pathway_sdaa(
  stratified_path,
  physeq,
  taxon_level = NULL,
  group,
  daa_method = "Maaslin2",
  p.adjust.method = "BH"
)
}
\arguments{
\item{physeq}{A phyloseq object containing sample metadata and taxonomy.}

\item{taxon_level}{Optional. Taxonomic level to aggregate taxa (e.g., "Genus"). If NULL, no aggregation is done.}

\item{group}{Character. The column name in metadata to use for group comparison (e.g., "prediabetes").}

\item{daa_method}{Character. Differential abundance method. Default is "Maaslin2".}

\item{p.adjust.method}{Character. Multiple testing correction method. Default is "BH".}

\item{picrust2_path}{Path to PICRUSt2 stratified KO output file ("pred_metagenome_contrib.tsv").}

\item{output_dir}{Character. Directory to store MaAsLin2 output. Default is "maaslin2_output".}
}
\value{
A named list of data frames containing KEGG-annotated significant features for each taxon.
}
\description{
Performs stratified differential abundance analysis (sDAA) using stratified KO predictions from PICRUSt2.
For each taxon, this function extracts its KO function profile and applies a differential abundance method (e.g., MaAsLin2).
Optionally, taxa can be aggregated to a specified taxonomic level before analysis.
}
