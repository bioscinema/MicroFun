% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pathway_sdaa.R, R/pathway_sdaa_V2.R
\name{pathway_sdaa}
\alias{pathway_sdaa}
\title{Stratified Pathway Differential Abundance Analysis}
\usage{
pathway_sdaa(
  stratified_path,
  physeq,
  taxon_level = "Genus",
  group,
  daa_method = "Maaslin2",
  p.adjust.method = "none",
  threshold = 0.05,
  direction = "taxa"
)

pathway_sdaa(
  stratified_path,
  physeq,
  taxon_level = "Genus",
  group,
  daa_method = "Maaslin2",
  p.adjust.method = "none",
  threshold = 0.05,
  direction = "taxa"
)
}
\arguments{
\item{stratified_path}{Path to the stratified output file from PICRUSt2 (typically `*_strat.tsv`).}

\item{physeq}{A `phyloseq` object containing sample data and taxonomic information.}

\item{taxon_level}{Character. Taxonomic level to aggregate contributions (e.g., `"Genus"`, `"Family"`). Default is `"Genus"`.}

\item{group}{Character. Column name in `sample_data(physeq)` that defines the grouping variable.}

\item{daa_method}{Character. Differential abundance method to use, e.g., `"Maaslin2"`, `"ALDEx2"`, etc. Default is `"Maaslin2"`.}

\item{p.adjust.method}{Character. Method for p-value adjustment (e.g., `"fdr"`, `"none"`). Default is `"none"`.}

\item{threshold}{Numeric. Significance threshold for adjusted p-values. Default is `0.05`.}

\item{direction}{Character. Whether to group by `"taxa"` or `"function"` for stratification. Default is `"taxa"`.}

\item{picrust2_path}{Path to PICRUSt2 stratified KO output file ("pred_metagenome_contrib.tsv").}

\item{output_dir}{Character. Directory to store MaAsLin2 output. Default is "maaslin2_output".}
}
\value{
A named list of data frames containing KEGG-annotated significant features for each taxon.

A named list of annotated differential abundance results per taxon or function.
}
\description{
Performs stratified differential abundance analysis (sDAA) using stratified KO predictions from PICRUSt2.
For each taxon, this function extracts its KO function profile and applies a differential abundance method (e.g., MaAsLin2).
Optionally, taxa can be aggregated to a specified taxonomic level before analysis.

This function performs stratified differential abundance analysis (DAA) using
PICRUSt2 functional output and phyloseq metadata, either by grouping ASV contributions
to functions (direction = "taxa") or by grouping taxonomic contributions to a specific function (direction = "function").
}
\details{
When `direction = "taxa"`, the function:
\itemize{
  \item Aggregates KO/function contributions from each taxon.
  \item Maps ASVs to taxonomic levels.
  \item Performs DAA using the selected method.
  \item Annotates significant features with KEGG pathway names.
}
When `direction = "function"`, the function:
\itemize{
  \item Aggregates taxon contributions per function.
  \item Compares taxa for each function using DAA.
  \item Annotates results using pathway names if available.
}
}
\examples{
\dontrun{
result <- pathway_sdaa(
  stratified_path = "pred_metagenome_strat.tsv",
  physeq = my_phyloseq_object,
  taxon_level = "Genus",
  group = "disease_status",
  daa_method = "Maaslin2",
  p.adjust.method = "fdr",
  threshold = 0.05,
  direction = "taxa"
)
}
}
