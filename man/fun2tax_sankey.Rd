% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fun2tax_sankey.R
\name{fun2tax_sankey}
\alias{fun2tax_sankey}
\title{Sankey diagram of functions (KO/EC/MetaCyc) to taxa}
\usage{
fun2tax_sankey(
  pathway_sdaa_result,
  pathway = c("KO", "EC", "MetaCyc"),
  group_functions = TRUE,
  taxa_list = NULL,
  node_color = c(Up = "#ffa551", Down = "#70afdf"),
  node_neutral = "#999999",
  label_left_sources = TRUE,
  margin = list(top = 10, right = 200, bottom = 10, left = 180),
  height = 1200,
  width = 1000
)
}
\arguments{
\item{pathway_sdaa_result}{Named list of results from \code{pathway_sdaa()}.
Each element should be a data.frame with at least the columns
\code{feature}, \code{logFC}, and an adjusted p-value column
(\code{p_adjust}, \code{padj}, \code{FDR}, \code{qval}, etc.).
List names must be function IDs (KO, EC, or MetaCyc identifiers).}

\item{pathway}{Character scalar. Functional namespace of the function IDs;
one of \code{"KO"}, \code{"EC"}, or \code{"MetaCyc"}.}

\item{group_functions}{Logical. If \code{TRUE}, function IDs are mapped to
higher-level group labels using reference mappings shipped in the package:
KO to PathwayL1, EC/MetaCyc to description. Default: \code{TRUE}.}

\item{taxa_list}{Optional character vector. If supplied, only edges whose
source (function group or raw function ID) matches one of these values
will be retained in the diagram.}

\item{node_color}{Named character vector of length 2 giving fill colors for
edges with positive logFC (\code{"Up"}) and negative logFC (\code{"Down"}).
Default: orange for Up (\code{"#ffa551"}), blue for Down (\code{"#70afdf"}).}

\item{node_neutral}{Character. Color used for neutral nodes (the default
group "All"). Default: \code{"#999999"}.}

\item{label_left_sources}{Logical. If \code{TRUE}, left-side node labels are
right-aligned and wrapped to avoid overlap. Default: \code{TRUE}.}

\item{margin}{List of integers. Margins for the sankey plot in pixels, with
elements \code{top}, \code{right}, \code{bottom}, \code{left}.
Default: \code{list(top=10, right=200, bottom=10, left=180)}.}

\item{height, width}{Numeric. Output height and width in pixels for the
interactive sankey widget.}
}
\description{
Build an interactive Sankey diagram showing connections between functions
(KO, EC, or MetaCyc identifiers, optionally grouped to higher-level categories)
and taxa/features from differential abundance analysis results. Edges are
colored by the sign of log fold change (Up/Down), while nodes are colored
with neutral or user-specified palettes.
}
\examples{
\dontrun{
# Example (toy data)
res <- list(
  K00001 = data.frame(feature = c("GenusA","GenusB"),
                      logFC   = c(1.2,-0.8),
                      p_adjust = c(0.01,0.2)),
  K00002 = data.frame(feature = c("GenusC"),
                      logFC   = c(-1.5),
                      p_adjust = c(0.04))
)

p <- fun2tax_sankey(res, pathway = "KO", group_functions = FALSE)
p   # interactive sankey widget
}

}
\seealso{
\code{\link{pathway_sdaa}}, \pkg{networkD3}, \pkg{htmlwidgets}
}
