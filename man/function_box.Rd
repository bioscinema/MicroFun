% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/function_box.R
\name{function_box}
\alias{function_box}
\title{Function-level boxplots of pathway contributions}
\usage{
function_box(
  stratified_path,
  pathway_sdaa_result,
  physeq,
  taxon_level = "Genus",
  group
)
}
\arguments{
\item{stratified_path}{Character scalar. Path to the stratified PICRUSt2 output
(e.g., \code{pred_metagenome_contrib.tsv}), which must contain at least
the columns \code{sample}, \code{taxon}, \code{function},
\code{norm_taxon_function_contrib}.}

\item{pathway_sdaa_result}{Named list of results from \code{pathway_sdaa()}.
Each element should be a data.frame with at least \code{feature} and
\code{pathway_name} (or \code{feature} only). The list names must correspond
to taxa labels (e.g., genera).}

\item{physeq}{A \code{phyloseq} object containing both taxonomy information
(via \code{tax_table}) and sample metadata (via \code{sample_data}).}

\item{taxon_level}{Character scalar. Taxonomic rank at which to aggregate
ASV-level contributions (e.g., \code{"Genus"}). Must be a column in
\code{phyloseq::tax_table(physeq)}.}

\item{group}{Character scalar. Column name in \code{sample_data(physeq)}
indicating the grouping variable (e.g., treatment, case/control).}
}
\description{
Generate per-taxon boxplots of functional contributions (e.g., KO/EC/MetaCyc)
from stratified PICRUSt2 outputs, grouped by sample metadata categories.
This function merges ASV-level stratified contributions into a chosen
taxonomy level (e.g., Genus) and produces boxplots for functions that are
significant in differential abundance analysis results from
\code{pathway_sdaa()}.
}
\examples{
\dontrun{
# Example usage
stratified_path <- "pred_metagenome_contrib.tsv"
plots <- function_box(
  stratified_path     = stratified_path,
  pathway_sdaa_result = sdaa_res,
  physeq              = physeq_obj,
  taxon_level         = "Genus",
  group               = "Group"
)
# Access the plot for GenusA
plots[["GenusA"]]
}

}
\seealso{
\code{\link{pathway_sdaa}}, \pkg{phyloseq}, \pkg{ggplot2}
}
