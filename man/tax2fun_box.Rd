% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tax2fun_box.R
\name{tax2fun_box}
\alias{tax2fun_box}
\title{Plot Functional Abundance Boxplots for Driving Taxa}
\usage{
tax2fun_box(
  stratified_path,
  pathway_sdaa_result,
  physeq,
  taxon_level = "Genus",
  group
)
}
\arguments{
\item{stratified_path}{Path to the stratified output file from PICRUSt2 (typically `*_strat.tsv`).}

\item{pathway_sdaa_result}{A named list of data.frames containing differential results
(with `feature` and `pathway_name`) for each taxon.}

\item{physeq}{A `phyloseq` object containing the microbial abundance table, taxonomy, and sample metadata.}

\item{taxon_level}{A string indicating the taxonomic level to aggregate functions by
(e.g., `"Genus"`, `"Family"`). Default is `"Genus"`.}

\item{group}{A string specifying the sample metadata column used for grouping in boxplots.}
}
\value{
A named list of `ggplot2` boxplot objects, one for each taxon with matching functional results.
}
\description{
This function generates boxplots of stratified functional pathway abundances
(from PICRUSt2 output) at a specified taxonomic level for each driving taxon,
grouped by a metadata variable.
}
\details{
This function:
\itemize{
  \item Parses PICRUSt2 stratified output and maps ASVs to their taxonomic levels.
  \item Aggregates function abundances at the taxon level.
  \item Filters and matches functions found in the user-provided differential result per taxon.
  \item Generates and returns a list of ggplot boxplots of function abundance by group.
}
}
\examples{
\dontrun{
plot_list <- tax2fun_box(
  stratified_path = "ko_metagenome_out/pred_metagenome_unstrat.tsv",
  pathway_sdaa_result = diff_results,
  physeq = my_phyloseq,
  taxon_level = "Genus",
  group = "disease_status"
)
plot_list$Bacteroides  # View boxplot for Bacteroides genus
}
}
