% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_function_dendrogram.R
\name{tax_fun_dendrogram}
\alias{tax_fun_dendrogram}
\title{Circular dendrogram of top-N functions per taxon}
\usage{
tax_fun_dendrogram(
  pathway_sdaa_result,
  taxa_list = NULL,
  top_n_per_genus = 5,
  wrap_width = 36,
  title = "Function dendrogram",
  point_size_range = c(1.5, 5),
  label_size = 2,
  label_priority = "pathway_name",
  palette = "Paired"
)
}
\arguments{
\item{pathway_sdaa_result}{Named list of results from \code{pathway_sdaa()}.
Each element should be a data.frame with at least a \code{logFC} column
and one of \code{pathway_name}, \code{feature}, or \code{function}.
The list names are used as genera/taxa labels.}

\item{taxa_list}{Optional character vector of genera to include. If \code{NULL}
(default), all taxa in \code{pathway_sdaa_result} are included.
If provided, missing taxa are reported in the return object.}

\item{top_n_per_genus}{Integer. Number of functions per genus to display
(ranked by absolute \code{logFC}). Default: 5.}

\item{wrap_width}{Integer. Width for wrapping long function labels.
Passed to \code{stringr::str_wrap()}. Default: 36.}

\item{title}{Character string, plot title. Default: \code{"Function dendrogram"}.}

\item{point_size_range}{Numeric length-2 vector. Range of point sizes for leaf
nodes, scaled to |logFC| values. Default: \code{c(1.5, 5)}.}

\item{label_size}{Numeric. Text size for function labels. Default: 2.}

\item{label_priority}{Character. Which column to use for labeling functions.
Must be one of \code{"pathway_name"}, \code{"feature"}, or \code{"function"}.
If the chosen column is absent, the function falls back to \code{feature}
or \code{function}. Default: \code{"pathway_name"}.}

\item{palette}{Character. Name of RColorBrewer palette to use for genus colors
(if \eqn{\leq 12} genera). Defaults to \code{"Paired"}. If there are more
than 12 genera, falls back to a hue-based palette from \pkg{scales}.}
}
\value{
A list with three elements:
  \item{plot}{A \code{ggplot} dendrogram object (from \pkg{ggraph}).}
  \item{used_taxa}{Character vector of genera included in the plot.}
  \item{missing_taxa}{Character vector of requested taxa (via \code{taxa_list})
  that were not found in \code{pathway_sdaa_result}.}
}
\description{
Create a circular dendrogram where each genus (or other taxon label)
branches to its top-N associated functions (ranked by |logFC|). Node
point size is proportional to |logFC|, and labels can be drawn from
different columns (pathway name, feature ID, or function description).
}
\details{
For each genus in the input, the function selects the top-N functions
ranked by absolute log fold change (\code{|logFC|}). It builds a dendrogram
with a single root node branching into genera nodes, which then branch into
leaf nodes (functions). Each leaf node is plotted with a size proportional
to \code{|logFC|}, and colored according to its genus.
}
\examples{
\dontrun{
# Fake input
res <- list(
  GenusA = data.frame(pathway_name = c("Glycolysis","TCA cycle"),
                      logFC = c(1.2,-0.8)),
  GenusB = data.frame(feature = c("K00001","K00002"),
                      logFC = c(2.1, 0.5))
)

dend <- tax_fun_dendrogram(res, top_n_per_genus = 2,
                           label_priority = "pathway_name")
dend$plot
}

}
\seealso{
\code{\link{pathway_sdaa}}, \pkg{ggraph}, \pkg{igraph}
}
