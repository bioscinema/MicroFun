% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tax2fun_dendro.R
\name{tax2fun_dendro}
\alias{tax2fun_dendro}
\title{Dendrogram of top stratified functions per taxon (circular)}
\usage{
tax2fun_dendro(
  pathway_sdaa_result,
  taxa_list = NULL,
  top_n_per_genus = 5,
  wrap_width = 36,
  title = "Function dendrogram",
  point_size_range = c(1.5, 5),
  label_size = 2
)
}
\arguments{
\item{pathway_sdaa_result}{A **named list** where each element corresponds to a
taxon (e.g., Genus) and contains a `data.frame` of differential results with
at least a `logFC` column and one label column among
`pathway_name`, `feature`, or `function` (the function tries them in that order).}

\item{taxa_list}{Optional character vector of taxon names to include (must match
names of `pathway_sdaa_result`). If `NULL`, all taxa in the list are used.}

\item{top_n_per_genus}{Integer. Number of functions to keep **per taxon** after
ranking by `abs(logFC)`. Default `5`.}

\item{wrap_width}{Integer. Maximum character width for wrapping function labels.
Default `36`.}

\item{title}{Character plot title. Default `"Function dendrogram"`.}

\item{point_size_range}{Numeric length-2 vector specifying the range of point
sizes mapped to \eqn{|logFC|}. Default `c(1.5, 5)`.}

\item{label_size}{Numeric. Text size for leaf labels. Default `2`.}
}
\value{
A named `list` with components:
\item{plot}{A `ggraph`/`ggplot` object (the circular dendrogram).}
\item{used_taxa}{Character vector of taxa actually plotted.}
\item{missing_taxa}{Character vector of requested taxa not found in `pathway_sdaa_result`.}
}
\description{
Build a **circular dendrogram** that connects each selected taxon (e.g., Genus)
to its **top-|logFC| functions** from a stratified pathway analysis result
(the list returned by `pathway_sdaa()` or a similar routine). Leaf nodes are
function labels colored by taxon, with point size proportional to
\eqn{|logFC|}. Ranking and selection use **absolute logFC only** (no p-value
filtering).
}
\details{
The function constructs a simple hierarchy: a root node → each selected taxon →
that taxon’s top functions. It then draws a circular dendrogram using **ggraph**
with edges colored by the **parent taxon** and leaf points sized by
\eqn{|logFC|}. Labels are wrapped to `wrap_width`.
**Note:** selection is based solely on `abs(logFC)`; if you want to enforce
significance, pre-filter `pathway_sdaa_result` before calling this function.
}
\section{Expected columns per taxon table}{

\describe{
  \item{logFC}{Numeric signed log fold-change used for ranking and point size.}
  \item{pathway_name / feature / function}{One of these will be used as the label (in this order).}
}
}

\examples{
\donttest{
# Suppose `res_list` is a named list of per-genus differential tables
# (each with columns like: pathway_name, feature, logFC).
# p_out <- tax2fun_dendro(res_list, top_n_per_genus = 8)
# p_out$plot
}

}
